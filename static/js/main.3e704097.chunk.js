(this["webpackJsonp@login-with-metamask/frontend"]=this["webpackJsonp@login-with-metamask/frontend"]||[]).push([[0],{14:function(e,t,n){},23:function(e,t,n){},26:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);n(14);var c=n(12),a=n(1),s=n(13),r=n.n(s),i=n(4),o=(n(23),n(3)),u=n(6),l=n(7),d=n.n(l),j=(n(26),n.p+"static/media/pdfpic.32e8b1a1.jpg"),p=n(0),h=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2);t[0],t[1];return Object(p.jsx)("div",{className:"mintzy",children:Object(p.jsxs)("div",{className:"picture-container",children:[Object(p.jsxs)("div",{className:"picture-box",children:[Object(p.jsx)("img",{src:j}),Object(p.jsx)("h1",{children:"STAKING POOL"})]}),Object(p.jsxs)("div",{className:"picture-box",children:[Object(p.jsx)("img",{src:j}),Object(p.jsx)("h1",{children:"FANTASY LEAGUE"})]}),Object(p.jsxs)("div",{className:"picture-box",children:[Object(p.jsx)("img",{src:j}),Object(p.jsx)("h1",{children:"P2E GAME"})]})]})})},b=(n(28),n.p+"static/media/LOGOTR.0b6c0854.png"),O=void 0,m=function(e){var t=e.onLoggedIn,n=Object(a.useState)(!1),c=Object(i.a)(n,2),s=c[0],r=c[1],l=function(e){var t=e.publicAddress,n=e.signature;return fetch("".concat("https://vast-forest-35363.herokuapp.com/api","/auth"),{body:JSON.stringify({publicAddress:t,signature:n}),headers:{"Content-Type":"application/json"},method:"POST"}).then((function(e){return e.json()}))},j=function(){var e=Object(u.a)(Object(o.a)().mark((function e(t){var n,c,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.publicAddress,c=t.nonce,e.prev=1,e.next=4,O.eth.personal.sign("I am signing my one-time nonce: ".concat(c),n,"");case 4:return a=e.sent,e.abrupt("return",{publicAddress:n,signature:a});case 8:throw e.prev=8,e.t0=e.catch(1),new Error("You need to sign the message to be able to log in.");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),h=function(e){return fetch("".concat("https://vast-forest-35363.herokuapp.com/api","/users"),{body:JSON.stringify({publicAddress:e}),headers:{"Content-Type":"application/json"},method:"POST"}).then((function(e){return e.json()}))},m=function(){var e=Object(u.a)(Object(o.a)().mark((function e(){var n,c;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.ethereum){e.next=3;break}return window.alert("Please install MetaMask first."),e.abrupt("return");case 3:if(O){e.next=14;break}return e.prev=4,e.next=7,window.ethereum.enable();case 7:O=new d.a(window.ethereum),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),window.alert("You need to allow MetaMask."),e.abrupt("return");case 14:return e.next=16,O.eth.getCoinbase();case 16:if(n=e.sent){e.next=20;break}return window.alert("Please activate MetaMask first."),e.abrupt("return");case 20:c=n.toLowerCase(),r(!0),fetch("".concat("https://vast-forest-35363.herokuapp.com/api","/users?publicAddress=").concat(c)).then((function(e){return e.json()})).then((function(e){return e.length?e[0]:h(c)})).then(j).then(l).then(t).catch((function(e){window.alert(e),r(!1)}));case 23:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:"page",children:[Object(p.jsx)("div",{className:"header",children:"Login with Metamask to proceed to our streaming dApp"}),Object(p.jsx)("div",{children:Object(p.jsx)("img",{src:b,className:"pic"})}),Object(p.jsx)("button",{className:"Login-button Login-mm",onClick:m,children:s?"Loading...":"Web3 Login"})]})},f=n(2),g=(n(29),n(10)),x=function(e){var t=e.auth,n=e.onLoggedOut,c=Object(a.useState)({loading:!1,user:void 0,username:""}),s=Object(i.a)(c,2),r=s[0],o=s[1];Object(a.useEffect)((function(){var e=t.accessToken,n=Object(g.a)(e).payload.id;fetch("".concat("https://vast-forest-35363.herokuapp.com/api","/users/").concat(n),{headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return o(Object(f.a)(Object(f.a)({},r),{},{user:e}))})).catch(window.alert)}),[]);var u=t.accessToken,l=Object(g.a)(u).payload.publicAddress,d=(r.loading,r.user),j=d&&d.username;return Object(p.jsxs)("div",{className:"Profile ",children:[Object(p.jsxs)("div",{className:"names",children:[j?Object(p.jsx)("pre",{children:j}):""," ",Object(p.jsx)("pre",{children:l})]}),Object(p.jsx)("p",{children:Object(p.jsx)("button",{className:"Login-button Login-mm",onClick:n,children:"Logout"})})]})},v=n.p+"static/media/PENALDO.98d36470.png",w="login-with-metamask:auth",N=function(){var e=Object(a.useState)({}),t=Object(i.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){var e=window.localStorage.getItem(w),t=e&&JSON.parse(e);c({auth:t})}),[]);var s=n.auth;return Object(p.jsx)("div",{className:"App",children:Object(p.jsx)("div",{className:"App-intro",children:s?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("header",{className:"App-header",children:[Object(p.jsx)("img",{src:v,className:"App-logo",alt:"logo"}),Object(p.jsx)("div",{className:"App-title",children:" SPORTS "}),Object(p.jsx)("div",{className:"App-title",children:" LIVE "}),Object(p.jsx)("div",{className:"App-title",children:" E-SPORTS "}),Object(p.jsx)("div",{className:"App-title",children:" BONUS "})]}),Object(p.jsx)(x,{auth:s,onLoggedOut:function(){localStorage.removeItem(w),c({auth:void 0})}}),Object(p.jsx)(h,{})]}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("header",{className:"App-header",children:Object(p.jsx)("img",{src:v,className:"App-logo",alt:"logo"})}),Object(p.jsx)(m,{onLoggedIn:function(e){localStorage.setItem(w,JSON.stringify(e)),c({auth:e})}})]})})})};Object(c.config)({path:".env.production"}),r.a.render(Object(p.jsx)(N,{}),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.3e704097.chunk.js.map